using System.Text.RegularExpressions;namespace ScraperBackendService.Core.Normalize;/// <summary>/// Utility class for cleaning titles before returning to frontend./// Removes subtitle annotations and other bracketed content that may interfere with title display./// </summary>public static class TitleCleaner{    /// <summary>    /// Pattern to match various subtitle annotations in brackets.    /// Matches Chinese, Japanese, Korean subtitle markers in [], (), 【】, （）, and ＜＞ brackets.    /// </summary>    private static readonly Regex SubtitleAnnotationRegex = new Regex(        @"\[中文字幕\]|\[繁体字幕\]|\[简体字幕\]|\[英文字幕\]|\[日文字幕\]|\[Korean字幕\]|\[한국어자막\]|" +        @"\[중국어자막\]|\[中文\]|\[繁体\]|\[简体\]|\[英文\]|\[日文\]|\[Korean\]|\[한국어\]|\[중국어\]|" +        @"\(中文字幕\)|\(繁体字幕\)|\(简体字幕\)|\(英文字幕\)|\(日文字幕\)|\(Korean字幕\)|\(한국어자막\)|" +        @"\(중국어자막\)|\(中文\)|\(繁体\)|\(简体\)|\(英文\)|\(日文\)|\(Korean\)|\(한국어\)|\(중국어\)|" +        @"【中文字幕】|【繁体字幕】|【简体字幕】|【英文字幕】|【日文字幕】|【Korean字幕】|【한국어자막】|" +        @"【중국어자막】|【中文】|【繁体】|【简体】|【英文】|【日文】|【Korean】|【한국어】|【중국어】|" +        @"＜中文字幕＞|＜繁体字幕＞|＜简体字幕＞|＜英文字幕＞|＜日文字幕＞|＜Korean字幕＞|＜한국어자막＞|" +        @"＜중국어자막＞|＜中文＞|＜繁体＞|＜简体＞|＜英文＞|＜日文＞|＜Korean＞|＜한국어＞|＜중국어＞",        RegexOptions.IgnoreCase | RegexOptions.Compiled);    /// <summary>    /// Additional patterns for common subtitle and language annotations.    /// Matches generic subtitle markers like SUB, DUB, RAW, and censorship indicators.    /// </summary>    private static readonly Regex AdditionalAnnotationRegex = new Regex(        @"\[字幕\]|\[SUB\]|\[DUB\]|\[RAW\]|\[无修正\]|\[有修正\]|\[修正版\]|\[无码\]|\[有码\]|" +        @"\(字幕\)|\(SUB\)|\(DUB\)|\(RAW\)|\(无修正\)|\(有修正\)|\(修正版\)|\(无码\)|\(有码\)|" +        @"【字幕】|【SUB】|【DUB】|【RAW】|【无修正】|【有修正】|【修正版】|【无码】|【有码】|" +        @"＜字幕＞|＜SUB＞|＜DUB＞|＜RAW＞|＜无修正＞|＜有修正＞|＜修正版＞|＜无码＞|＜有码＞",        RegexOptions.IgnoreCase | RegexOptions.Compiled);    /// <summary>    /// Cleans title by removing subtitle annotations and other unwanted bracketed content.    /// This method processes titles through multiple stages:    /// 1. Removes specific subtitle language annotations (Chinese, Japanese, Korean, etc.)    /// 2. Removes generic subtitle markers (SUB, DUB, RAW, censorship indicators)    /// 3. Normalizes whitespace by collapsing multiple spaces into single spaces    /// 4. Trims leading and trailing whitespace    /// </summary>    /// <param name="title">The original title to clean. Can be null or whitespace.</param>    /// <returns>    /// Cleaned title with subtitle annotations removed.     /// Returns empty string if input is null or whitespace.    /// </returns>    /// <example>    /// var cleaned = TitleCleaner.CleanTitle("Example Title [中文字幕]");    /// // Returns: "Example Title"    ///     /// var cleaned2 = TitleCleaner.CleanTitle("[繁体字幕] Another Title (中文字幕)");    /// // Returns: "Another Title"    ///     /// var cleaned3 = TitleCleaner.CleanTitle("Title [SUB] [RAW] [无码]");    /// // Returns: "Title"    /// </example>    public static string CleanTitle(string? title)    {        if (string.IsNullOrWhiteSpace(title))        {            return string.Empty;        }        var cleaned = title.Trim();        // Remove subtitle annotations        cleaned = SubtitleAnnotationRegex.Replace(cleaned, string.Empty);        // Remove additional annotations        cleaned = AdditionalAnnotationRegex.Replace(cleaned, string.Empty);        // Clean up extra whitespace and normalize        cleaned = Regex.Replace(cleaned, @"\s+", " ").Trim();        return cleaned;    }}